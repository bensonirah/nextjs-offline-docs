(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3219],{10805:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/next-8",function(){return c(98024)}])},33935:function(a,b,c){"use strict";var d=c(24246),e=c(79892),f=c.n(e),g=c(6174);function h(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}b.Z=function(a){return(0,d.jsxs)("div",{className:"jsx-56922f79e7dcb98b tweet-wrapper",children:[(0,d.jsx)(g.Z,function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){h(a,b,c[b])})}return a}({},a)),(0,d.jsx)(f(),{id:"56922f79e7dcb98b",children:".tweet-wrapper.jsx-56922f79e7dcb98b{margin:40px 0}"})]})}},90603:function(a,b,c){"use strict";var d=c(24246);c(27378);var e=c(38579),f=c(54616),g=c.n(f);function h(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}b.Z=function(a){var b=a.caption,c=a.margin,f=a.captionSpacing,i=void 0===f?null:f,j=a.shadow,k=function(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],b.indexOf(c)>=0||(e[c]=a[c]);return e}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}(a,["caption","margin","captionSpacing","shadow"]);return(0,d.jsxs)("figure",{className:g().figure,style:{margin:"".concat(void 0===c?40:c,"px 0")},children:[(0,d.jsx)(e.default,function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){h(a,b,c[b])})}return a}({},k,{className:void 0!==j&&j?g().shadow:""})),b&&(0,d.jsx)("figcaption",{className:g().figcaption,style:i?{marginTop:i}:{},children:b})]})}},72298:function(a,b,c){"use strict";c.r(b),c.d(b,{meta:function(){return j},"default":function(){return k}});var d=c(24246),e=c(27378),f=c(65977);function g(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function h(a){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function i(a,b){return(i=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var j={title:"Next.js 8",description:"Next.js 8 introduces Serverless Mode, smaller bundles, performance improvements, and more",date:"2019-02-11T08:00:35.009Z",url:"https://nextjs.org/blog/next-8",link:"/blog/next-8",authors:[{name:"Tim Neutkens",avatar:"/static/team/tim.jpg",twitter:"timneutkens"},{name:"Connor Davis",avatar:"/static/team/connor.jpg",twitter:"connordav_is"},{name:"Shu Ding",twitter:"shuding_",avatar:"/static/team/shu.jpg"}]},k=function(a){"use strict";!function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&i(a,b)}(m,a);var b,c,e,j,k,l=(j=m,k=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var a,b,c,d,e=h(j);if(k){var f=h(this).constructor;d=Reflect.construct(e,arguments,f)}else d=e.apply(this,arguments);return b=this,(c=d)&&("object"==((a=c)&&"undefined"!=typeof Symbol&&a.constructor===Symbol?"symbol":typeof a)||"function"==typeof c)?c:(function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a})(b)});function m(a){var b;return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,m),(b=l.call(this,a)).layout=null,b}return b=m,c=[{key:"render",value:function(){var a=this.props,b=a.components;return(function(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],b.indexOf(c)>=0||(e[c]=a[c]);return e}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}})(a,["components"]),(0,d.jsxs)(f.XJ,{name:"wrapper",components:b,children:[(0,d.jsx)(f.XJ,{name:"p",components:b,children:"We are proud today to introduce the production-ready Next.js 8, featuring:"}),(0,d.jsxs)(f.XJ,{name:"ul",components:b,children:[(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#serverless-nextjs"},children:"Serverless Next.js"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#massive-build-time-memory-usage-reduction"},children:"Massive build-time memory usage reduction"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#build-time-environment-configuration"},children:"Build-time environment configuration"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#prefetch-performance-improvements"},children:"Prefetch performance improvements"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#smaller-initial-html-size"},children:"Smaller initial HTML size"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#improved-on-demand-entries"},children:"Improved on-demand entries"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#faster-port-listening-in-development"},children:"Faster port listening in development"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#faster-static-export"},children:"Faster Static Export"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#head-element-deduplication"},children:"Head element deduplication"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#new-crossorigin-config-option"},children:"New crossOrigin config option"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#removed-inline-javascript"},children:"Removed inline Javascript"})}),(0,d.jsx)(f.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(f.XJ,{name:"a",components:b,parentName:"li",props:{href:"#example-of-api-authentication"},children:"Example of API Authentication"})})]})]})}}],g(b.prototype,c),e&&g(b,e),m}(e.Component);k.isMDXComponent=!0},98024:function(a,b,c){"use strict";c.r(b),c.d(b,{"default":function(){return t}});var d=c(24246),e=c(79892),f=c.n(e),g=c(27378),h=c(65977),i=c(85329),j=c(24945),k=c(90603),l=c(72298),m=c(74843);c(88038);var n=c(33935);function o(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function p(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function q(a){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function r(a,b){return(r=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var s={},t=function(a){"use strict";!function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&r(a,b)}(v,a);var b,c,e,g,t,u=(g=v,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var a,b,c,d,e=q(g);if(t){var f=q(this).constructor;d=Reflect.construct(e,arguments,f)}else d=e.apply(this,arguments);return b=this,(c=d)&&("object"==((a=c)&&"undefined"!=typeof Symbol&&a.constructor===Symbol?"symbol":typeof a)||"function"==typeof c)?c:(function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a})(b)});function v(a){var b;return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,v),(b=u.call(this,a)).layout=(0,i.Z)(function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){p(a,b,c[b])})}return a}({},l.meta)),b}return b=v,c=[{key:"render",value:function(){var a=this.props,b=a.components,c=function(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],b.indexOf(c)>=0||(e[c]=a[c]);return e}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}(a,["components"]);return(0,d.jsxs)(h.XJ,{name:"wrapper",Layout:this.layout,layoutProps:Object.assign({},s,c),components:b,children:[(0,d.jsx)(h.XJ,{name:"p",components:b,children:"We are proud today to introduce the production-ready Next.js 8, featuring:"}),(0,d.jsxs)(h.XJ,{name:"ul",components:b,children:[(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#serverless-nextjs"},children:"Serverless Next.js"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#massive-build-time-memory-usage-reduction"},children:"Massive build-time memory usage reduction"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#build-time-environment-configuration"},children:"Build-time environment configuration"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#prefetch-performance-improvements"},children:"Prefetch performance improvements"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#smaller-initial-html-size"},children:"Smaller initial HTML size"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#improved-on-demand-entries"},children:"Improved on-demand entries"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#faster-port-listening-in-development"},children:"Faster port listening in development"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#faster-static-export"},children:"Faster Static Export"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#head-element-deduplication"},children:"Head element deduplication"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#new-crossorigin-config-option"},children:"New crossOrigin config option"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#removed-inline-javascript"},children:"Removed inline Javascript"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"#example-of-api-authentication"},children:"Example of API Authentication"})})]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["As always, we have strived to ensure all these benefits are ",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"p",children:"completely backwards compatible"}),". For most Next.js applications, all you need to do is run:"]}),(0,d.jsx)(m.it,{prefix:!0,children:"npm i next@latest react@latest react-dom@latest"}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["We are thankful to our community and everyone who has bet on our success. Since our last blog post, we have seen companies like ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://att.com"},children:"AT&T"}),", ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://www.starbucksreserve.com/en-us"},children:"Starbucks"})," and ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://m.twitch.tv/"},children:"Twitch"})," relaunch their public-facing websites and apps with Next.js."]}),(0,d.jsx)(h.XJ,{name:"h2",components:b,children:"Serverless Next.js"}),(0,d.jsx)(j.n,{caption:"The Next.js serverless target outputs Serverless functions from pages",captionSpacing:30,src:"/static/blog/next-8/static-exporting.mp4",width:1051,height:344}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Serverless deployment dramatically improves reliability and scalability by splitting your application into smaller parts (also called\xa0",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"p",children:"lambdas"}),"). In the case of Next.js, each page in the\xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"pages"}),"\xa0directory becomes a serverless lambda."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["There are\xa0",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://vercel.com/docs/serverless-functions/conceptual-model"},children:"a number of benefits"}),"\xa0to serverless. The referenced link talks about some of them in the context of Express, but the principles apply universally: serverless allows for distributed points of failure, infinite scalability, and is incredibly affordable with a \"pay for what you use\" model."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["To enable\xa0",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"p",children:"serverless mode"}),"\xa0in Next.js, add the\xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"serverless"}),"\xa0 build \xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"target"}),"\xa0in \xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"next.config.js"}),":"]}),(0,d.jsx)(h.XJ,{name:"pre",components:b,props:{className:"language-js"},children:(0,d.jsxs)(h.XJ,{name:"code",components:b,parentName:"pre",props:{className:"language-js"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token comment"},children:"// next.config.js"}),"\nmodule",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"."}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token property-access"},children:"exports"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:"="})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"{"}),"\n  target",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:":"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token string"},children:"'serverless'"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"}"}),"\n"]})}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["The\xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"serverless"}),"\xa0target will output a single lambda per page. This file is completely standalone and does not require any dependencies to run:"]}),(0,d.jsxs)(h.XJ,{name:"ul",components:b,children:[(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:[(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"pages/index.js"}),"\xa0=>\xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:".next/serverless/pages/index.js"})]}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:[(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"pages/about.js"}),"\xa0=>\xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:".next/serverless/pages/about.js"})]})]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"The signature of the Next.js Serverless function is similar to the Node.js HTTP server callback:"}),(0,d.jsx)(h.XJ,{name:"pre",components:b,props:{className:"language-ts"},children:(0,d.jsxs)(h.XJ,{name:"code",components:b,parentName:"pre",props:{className:"language-ts"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"export"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"function"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token function"},children:"render"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token parameter"},children:["req",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:":"})," http",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"."}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token property-access"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token maybe-class-name"},children:"IncomingMessage"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:","})," res",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:":"})," http",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"."}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token property-access"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token maybe-class-name"},children:"ServerResponse"})})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token arrow operator"},children:"=>"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"void"}),"\n"]})}),(0,d.jsxs)(h.XJ,{name:"ul",components:b,children:[(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"https://nodejs.org/api/http.html#http_class_http_incomingmessage"},children:"http.IncomingMessage"})}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"https://nodejs.org/api/http.html#http_class_http_serverresponse"},children:"http.ServerResponse"})}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:[(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"void"}),"\xa0refers to the function not having a return value and is equivalent to JavaScript's\xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"undefined"}),". Calling the function will finish the request."]})]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"Next.js provides low-level APIs for serverless deployments as hosting platforms have different function signatures. In general you will want to wrap the output of a Next.js serverless build with a compatibility layer."}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["For example if the platform supports the Node.js\xa0",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://nodejs.org/api/http.html#http_class_http_server"},children:"http.Server"}),"\xa0class:"]}),(0,d.jsx)(h.XJ,{name:"pre",components:b,props:{className:"language-js"},children:(0,d.jsxs)(h.XJ,{name:"code",components:b,parentName:"pre",props:{className:"language-js"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"const"})," http ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:"="})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token function"},children:"require"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token string"},children:"'http'"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"const"})," page ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:"="})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token function"},children:"require"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token string"},children:"'./.next/serverless/about.js'"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"const"})," server ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:"="})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"new"})," ",(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token class-name"},children:["http",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"."}),"Server"]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token parameter"},children:["req",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:","})," res"]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token arrow operator"},children:"=>"})," page",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"."}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token method function property-access"},children:"render"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),"req",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:","})," res",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"}),"\nserver",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"."}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token method function property-access"},children:"listen"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token number"},children:"3000"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:","})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token arrow operator"},children:"=>"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token console class-name"},children:"console"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"."}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token method function property-access"},children:"log"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token string"},children:"'Listening on http://localhost:3000'"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"}),"\n"]})}),(0,d.jsx)(h.XJ,{name:"h3",components:b,children:(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"h3",children:"Summary"})}),(0,d.jsxs)(h.XJ,{name:"ul",components:b,children:[(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:"Low-level API for implementing serverless deployment"}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:["Every page in the\xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"pages"}),"\xa0directory becomes a serverless function (lambda)"]}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:["Creates the smallest possible serverless function (",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"li",children:"50 KB"})," base zip size)"]}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:["Optimized for fast\xa0",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"https://vercel.com/docs/serverless-functions/conceptual-model"},children:"cold start"}),"\xa0of the function"]}),(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:"The serverless function has 0 dependencies (they are included in the function bundle)"}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:["Uses the\xa0",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"https://nodejs.org/api/http.html#http_class_http_incomingmessage"},children:"http.IncomingMessage"}),"\xa0and\xa0",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"li",props:{href:"https://nodejs.org/api/http.html#http_class_http_serverresponse"},children:"http.ServerResponse"}),"\xa0from Node.js"]}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:["opt-in using\xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"target: 'serverless'"}),"\xa0in\xa0",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"next.config.js"})]}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:["The ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"server"})," target is still fully supported and maintained"]}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:[(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"publicRuntimeConfig"})," and ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"serverRuntimeConfig"})," are not supported in the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"serverless"})," mode. Use build-time configuration instead."]})]}),(0,d.jsx)(h.XJ,{name:"h2",components:b,children:"Massive build-time memory usage reduction"}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"We have contributed to webpack to improve Next.js's (and the rest of the webpack ecosystem's!) build performance and resource utilization."}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["This effort has resulted in up to ",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"p",children:"16 times better memory usage with no degradation in performance"}),"."]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"Memory gets released much more quickly and processes don't crash anymore under lots of stress (many pages)."}),(0,d.jsx)(n.Z,{id:"1085398982753468416",options:{conversation:"none",align:"center"}}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["We will be going in-depth on how we've achieved this optimization soon. Keep an eye out on the ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"/blog"},children:"Next.js blog"}),"."]}),(0,d.jsx)(h.XJ,{name:"h2",components:b,children:"Build-time environment configuration"}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["While reviewing Next.js applications an often reoccurring pattern we observed was adding ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"babel-plugin-transform-define"})," or ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"webpack.DefinePlugin"})," to provide configuration values to the application."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["With Next.js 8 we are introducing a new key to ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"next.config.js"})," named ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"env"})," to provide the same functionality in a backward compatible way:"]}),(0,d.jsx)(h.XJ,{name:"pre",components:b,props:{className:"language-js"},children:(0,d.jsxs)(h.XJ,{name:"code",components:b,parentName:"pre",props:{className:"language-js"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token comment"},children:"// next.config.js"}),"\nmodule",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"."}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token property-access"},children:"exports"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:"="})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"{"}),"\n  env",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:":"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"{"}),"\n    customKey",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:":"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token string"},children:"'MyValue'"}),"\n  ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"}"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"}"}),"\n"]})}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["This will allow you to use ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"process.env.customKey"})," in your code. For example:"]}),(0,d.jsx)(h.XJ,{name:"pre",components:b,props:{className:"language-js"},children:(0,d.jsxs)(h.XJ,{name:"code",components:b,parentName:"pre",props:{className:"language-js"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token comment"},children:"// pages/index.js"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"export"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"default"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"function"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token function"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token maybe-class-name"},children:"IndexPage"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"{"}),"\n  ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"return"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:"<"}),"h1",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:">"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token maybe-class-name"},children:"The"})," value ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"of"})," customKey is",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:":"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"{"}),"process",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"."}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token property-access"},children:"env"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"."}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token property-access"},children:"customKey"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"}"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:"<"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:"/"}),"h1",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:">"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"}"}),"\n"]})}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:[(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"process.env.customKey"})," will be replaced with ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"'MyValue'"})," at build time."]}),(0,d.jsx)(h.XJ,{name:"h2",components:b,children:"Prefetch performance improvements"}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"The Next.js router allows you to prefetch pages for faster navigation:"}),(0,d.jsx)(h.XJ,{name:"pre",components:b,props:{className:"language-jsx"},children:(0,d.jsxs)(h.XJ,{name:"code",components:b,parentName:"pre",props:{className:"language-jsx"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"import"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token maybe-class-name"},children:"Link"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"from"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token string"},children:"'next/link'"}),"\n\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"export"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"default"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"function"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token function"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token maybe-class-name"},children:"IndexPage"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"{"}),"\n  ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"return"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),"\n    ",(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n      "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token class-name"},children:"Link"})]})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-name"},children:"href"}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-value"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"="}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""}),"/about",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""})]})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-name"},children:"prefetch"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n        "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"}),"a"]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"To About Page"}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"</"}),"a"]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n      "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"</"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token class-name"},children:"Link"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n    "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"</"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),"\n  ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"}"}),"\n"]})}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["It works by prefetching the Javascript bundle of every link that has a ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"prefetch"})," attribute."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["In versions before Next.js 8 this would mean injecting a ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<script>"})," tag into the document ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<body>"}),"."]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"However, this introduced some overhead while opening pages, most notably the browser \"loading\" indication would show longer than you would expect even though the page could be interacted with already."}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["In Next.js 8 ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"prefetch"})," uses ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<link rel=\"preload\">"})," instead of a ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<script>"})," tag. It also only starts prefetching after ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"onload"})," to allow the browser to manage resources."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Additionally, Next.js now detects 2G internet and ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"navigator.connection.saveData"})," mode to disable prefetch on slower network connections."]}),(0,d.jsx)(h.XJ,{name:"h2",components:b,children:"Smaller initial HTML size"}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["As Next.js pre-renders HTML, it wraps pages into a default structure with ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<html>"}),", ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<head>"}),", ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<body>"})," and the JavaScript files needed to render the page."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["With ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://nextjs.org/blog/next-7/#smaller-initial-html-payload"},children:"Next.js 7 we optimized the initial payload to 1.50KB"}),", which was a 7.4% reduction from the previous version."]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"We were able to further reduce the initial payload size to 1.16KB a further 23% reduction:"}),(0,d.jsxs)("table",{className:"jsx-6925926a911597b0",children:[(0,d.jsx)("thead",{className:"jsx-6925926a911597b0",children:(0,d.jsxs)("tr",{className:"jsx-6925926a911597b0",children:[(0,d.jsx)("th",{className:"jsx-6925926a911597b0",children:"\xa0"}),(0,d.jsx)("th",{className:"jsx-6925926a911597b0",children:"7.0"}),(0,d.jsx)("th",{className:"jsx-6925926a911597b0",children:(0,d.jsx)("b",{className:"jsx-6925926a911597b0",children:"8.0"})}),(0,d.jsx)("th",{className:"jsx-6925926a911597b0",children:"delta"})]})}),(0,d.jsx)("tbody",{className:"jsx-6925926a911597b0",children:(0,d.jsxs)("tr",{className:"jsx-6925926a911597b0",children:[(0,d.jsx)("td",{className:"jsx-6925926a911597b0",children:"Document size (server rendered)"}),(0,d.jsx)("td",{className:"jsx-6925926a911597b0",children:(0,d.jsx)("b",{className:"jsx-6925926a911597b0",children:"1.50KB"})}),(0,d.jsx)("td",{className:"jsx-6925926a911597b0",children:(0,d.jsx)("b",{className:"jsx-6925926a911597b0",children:"1.16KB"})}),(0,d.jsxs)("td",{className:"jsx-6925926a911597b0",children:[(0,d.jsx)("b",{className:"jsx-6925926a911597b0",children:"23%"}),(0,d.jsx)("em",{className:"jsx-6925926a911597b0",children:"smaller"})]})]})})]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"The main ways we have reduced size are:"}),(0,d.jsxs)(h.XJ,{name:"ul",components:b,children:[(0,d.jsx)(h.XJ,{name:"li",components:b,parentName:"ul",children:"The page initialization inline script was removed"}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:["The ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"li",children:"/_error"})," page is no longer included on every page load"]})]}),(0,d.jsxs)(h.XJ,{name:"h3",components:b,children:["On-demand loading of /","_","error"]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Whenever an error occurs in production the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"/_error"})," page is rendered to display that an error occurred."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Ever since the first release of Next.js the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"/_error"})," page script tag was part of the initial HTML, meaning it was loaded even though it wouldn't be used if there were no runtime errors."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Starting with Next.js 8 the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"/_error"})," page is loaded on-demand when an error occurs."]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"Meaning that there is less code to be loaded, parsed, and executed by default."}),(0,d.jsx)(h.XJ,{name:"h2",components:b,children:"DX Improvements"}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["One of Next.js's primary goals is to provide the best production performance with ",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"p",children:"the best possible developer experience"}),". This release includes many subtle improvements based on user feedback."]}),(0,d.jsx)(h.XJ,{name:"h3",components:b,children:"Improved on-demand entries"}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Out of the box, Next.js automatically compiles only pages that are ",(0,d.jsx)(h.XJ,{name:"em",components:b,parentName:"p",children:"actively"})," being developed. Next.js does not compile all pages in the pages directory each time ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"next dev"})," is run. Instead, it compiles pages as you access them."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["For example, when visiting ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"http://localhost:3000/my-page"}),", the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"pages/my-page.js"})," file is compiled on-demand, after which the page is rendered."]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"This ensures the developer does not have to wait for all pages to compile when launching the development server, which can take quite some time on larger apps. It keeps memory usage low and the compiler fast since the compiler is not required to take all pages into account when bundling."}),(0,d.jsx)(k.Z,{caption:"The on-demand entries flow",captionSpacing:30,src:"/static/blog/next-8/flow.jpg",width:483,height:530.5}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"When a page has not been accessed for 25 seconds, it will be disposed from the compiler's build cache to keep the compiler fast and reduce memory usage."}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"The way Next.js keeps track of pages being accessed is using a polling mechanism. Every 5 seconds, an \"on-demand-entries-ping\" is sent to make the Next.js development server aware that a given page is being accessed."}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Since the initial release of this feature, the ping was done using a ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"window.fetch"})," call, meaning that every time the ping was triggered, it would show up in browser development tools on the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"console"})," and ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"network"})," tab."]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"One of the most requested features is the ability to hide these requests from the browser developer tools since these requests can add unnecessary noise."}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["We are excited to announce that in Next.js 8, the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"fetch"})," based ping has been replaced by a WebSockets-based approach, meaning that pings still happen but are only visible when inspecting the WebSocket connection."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Special thanks to ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://github.com/ijjk"},children:"JJ Kasper"})," for collaborating on the conversion to WebSockets."]}),(0,d.jsx)(h.XJ,{name:"h3",components:b,children:"Faster port listening in development"}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["When starting the Next.js development server, it has to run some initial compilation to be able to serve requests, by default, Next.js would wait for this compilation step to finish before starting the HTTP server, meaning that if you ran ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"next dev"})," and then went to your browser it could sometimes happen that you'd get a \"This site cant be reached\" message because the HTTP server was not listening for connections yet."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["With Next.js 8 the HTTP will be listening for connections before the compilation starts, meaning that if you go to ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"http://localhost:3000/"})," before compilation has finished the request will wait for the initial compilation to finish before serving the request, instead of having to refresh the page until it becomes available."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Special thanks to ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://github.com/exogen"},children:"Brian Beck"})," for implementing this feature."]}),(0,d.jsx)(h.XJ,{name:"h2",components:b,children:"Faster Static Export"}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Next.js focuses on the idea of\xa0",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"p",children:"pre-rendering"}),"\xa0as a means to achieve high performance. Pre-rendering comes in two forms:"]}),(0,d.jsxs)(h.XJ,{name:"ul",components:b,children:[(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:[(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"li",children:"Server rendering"}),"\nwhere each request triggers a render. As a result, the end-user doesn't have to wait for any JS to be downloaded to start consuming data"]}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:[(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"li",children:"Static rendering"}),"\nwhere we output static files that can be served directly without any code execution on the server"]})]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Starting from Next.js 8, static rendering through ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"next export"})," will have speed improvements if your machine has multiple CPUs."]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"Based on tests with a 4 CPU cores MacBook the exporting speed went from approximately 25 pages per second to 75 pages per second by taking advantage of all cores to pre-rendering pages."}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"Next.js will automatically detect the number of CPU cores and distribute the pages accordingly, no need for any code changes."}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Special thanks to ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://github.com/bkniffler"},children:"Benjamin Kniffler"})," for implementing this feature."]}),(0,d.jsx)(h.XJ,{name:"h2",components:b,children:"Head element deduplication"}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["A common need when building applications is updating the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<head>"})," element of a page. For example to set the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<title>"})," or ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<meta name=\"viewport\">"})," for responsive design."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Next.js exposes a built-in component to introduce changes to the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<head>"}),":"]}),(0,d.jsx)(h.XJ,{name:"pre",components:b,props:{className:"language-jsx"},children:(0,d.jsxs)(h.XJ,{name:"code",components:b,parentName:"pre",props:{className:"language-jsx"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"import"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token maybe-class-name"},children:"Head"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"from"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token string"},children:"'next/head'"}),"\n\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"export"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"default"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"function"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token function"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token maybe-class-name"},children:"IndexPage"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"{"}),"\n  ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"return"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),"\n    ",(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n      "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token class-name"},children:"Head"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n        "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"}),"title"]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"My page title"}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"</"}),"title"]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n      "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"</"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token class-name"},children:"Head"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n    "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"</"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),"\n  ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"}"}),"\n"]})}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["The ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<Head>"})," component can even be used multiple times in different components, for example your layout component could set some default head tags."]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"However, you might want to override the default head tags with a different value, in older versions of Next.js this would cause the tag to be duplicated in the output, as there was no way to deduplicate tags."}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["For this reason, it is now possible to provide a ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"key"})," property to every element inside the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<Head>"})," component which will automatically deduplicate tags with the same ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"key"})," value."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["When setting ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"key=\"viewport\""})," on two tags only the last one is rendered."]}),(0,d.jsx)(h.XJ,{name:"pre",components:b,props:{className:"language-jsx"},children:(0,d.jsxs)(h.XJ,{name:"code",components:b,parentName:"pre",props:{className:"language-jsx"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"import"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token maybe-class-name"},children:"Head"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"from"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token string"},children:"'next/head'"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"export"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword module"},children:"default"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"function"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token function"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token maybe-class-name"},children:"IndexPage"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"{"}),"\n  ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token keyword"},children:"return"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"("}),"\n    ",(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n      "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token class-name"},children:"Head"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n        "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"}),"title"]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"My page title"}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"</"}),"title"]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n        "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"}),"meta"]}),"\n          ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-name"},children:"name"}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-value"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"="}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""}),"viewport",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""})]}),"\n          ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-name"},children:"content"}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-value"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"="}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""}),"initial-scale=1.0, width=device-width",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""})]}),"\n          ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-name"},children:"key"}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-value"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"="}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""}),"viewport",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""})]}),"\n        ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"/>"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n      "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"</"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token class-name"},children:"Head"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n      "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token class-name"},children:"Head"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n        "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"<"}),"meta"]}),"\n          ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-name"},children:"name"}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-value"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"="}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""}),"viewport",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""})]}),"\n          ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-name"},children:"content"}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-value"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"="}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""}),"initial-scale=1.2, width=device-width",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""})]}),"\n          ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-name"},children:"key"}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token attr-value"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"="}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""}),"viewport",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"\""})]}),"\n        ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"/>"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n      "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"</"}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token class-name"},children:"Head"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token plain-text"},children:"\n    "}),(0,d.jsxs)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token tag"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token tag"},children:(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:"</"})}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"span",props:{className:"token punctuation"},children:">"})]}),"\n  ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:")"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"}"}),"\n"]})}),(0,d.jsx)(h.XJ,{name:"h2",components:b,children:"Security improvements"}),(0,d.jsxs)(h.XJ,{name:"h3",components:b,children:["New ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"h3",children:"crossOrigin"})," config option"]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["In Next.js 6 we introduced the option to add a ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"crossOrigin"})," attribute to ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<Head>"})," and ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<NextScript>"})," in ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"pages/_document.js"}),", however this did not cover all use cases for setting ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"cross-origin"}),"."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Next.js has a client-side router that dynamically injects ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<script>"})," tags, these tags were missing the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"cross-origin"})," attribute when injected."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["To ensure all ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<script>"})," tags have the ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"cross-origin"})," set, we have introduced a new configuration option in ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"next.config.js"})]}),(0,d.jsx)(h.XJ,{name:"pre",components:b,props:{className:"language-jsx"},children:(0,d.jsxs)(h.XJ,{name:"code",components:b,parentName:"pre",props:{className:"language-jsx"},children:[(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token comment"},children:"// next.config.js"}),"\nmodule",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"."}),(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token property-access"},children:"exports"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token operator"},children:"="})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"{"}),"\n  crossOrigin",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:":"})," ",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token string"},children:"'anonymous'"}),"\n",(0,d.jsx)(h.XJ,{name:"span",components:b,parentName:"code",props:{className:"token punctuation"},children:"}"}),"\n"]})}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Another benefit of introducing this option is that a custom ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"pages/_document.js"})," is no longer needed to set up ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"cross-origin"})," in your application."]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"The previous behavior is still supported but will emit a warning in development to aid developers in moving to the newly introduced option."}),(0,d.jsx)(h.XJ,{name:"h3",components:b,children:"Removed inline Javascript"}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["When using Next.js 7 and below, to enable ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"},children:"Content Security Policy (CSP)"})," the user had to include ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"script-src 'unsafe-inline'"})," in their policy because Next.js would create an inline ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"<script>"})," tag to pass data, for example, to pass the result of ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"getInitialProps"})," to the client side."]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"With Next.js 8 we have changed this inline script tag to a JSON tag for safe transfer to the client. This means that there are no inline scripts included by Next.js anymore."}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["With careful consideration ",(0,d.jsx)(h.XJ,{name:"inlineCode",components:b,parentName:"p",children:"script-src 'self'"})," can now be used."]}),(0,d.jsx)(h.XJ,{name:"h3",components:b,children:"Example of API Authentication"}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["One of the ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://github.com/vercel/next.js/issues/153"},children:"most requested examples of all time"})," has been how to do authentication in Next.js against an external API, any API, in any programming language."]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["With the introduction of Next.js 8, we are also introducing a newly created example: ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://github.com/vercel/next.js/tree/canary/examples/with-cookie-auth"},children:"with-cookie-auth"})]}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"This example shows how to authenticate against an external Node.js API, but the concepts applied work for any stateless API."}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"The example uses a cookie to share the token between the server-side and client-side rendering."}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"That way if the app is rendered on the server, it can still fetch authenticated data on the user's behalf."}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["Special thanks to ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://github.com/j0lv3r4"},children:"Juan Olvera"})," who contributed the example."]}),(0,d.jsx)(h.XJ,{name:"h2",components:b,children:"Community"}),(0,d.jsx)(h.XJ,{name:"p",components:b,children:"Ever since its first release, Next.js has been used in everything from Fortune 500 companies to personal blogs. We're very excited to see the continued growth in Next.js adoption."}),(0,d.jsxs)(h.XJ,{name:"ul",components:b,children:[(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:["We've had over ",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"li",children:"600 contributors"})," landing at least 1 commit."]}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:["On GitHub, the project has been starred over ",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"li",children:"34,400 times"}),"."]}),(0,d.jsxs)(h.XJ,{name:"li",components:b,parentName:"ul",children:["Over ",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"li",children:"2600 pull requests"})," were submitted since the first release."]})]}),(0,d.jsxs)(h.XJ,{name:"p",components:b,children:["The Next.js community has over ",(0,d.jsx)(h.XJ,{name:"strong",components:b,parentName:"p",children:"4,570 members"}),". ",(0,d.jsx)(h.XJ,{name:"a",components:b,parentName:"p",props:{href:"https://github.com/vercel/next.js/discussions"},children:"Join us!"})]}),(0,d.jsx)(f(),{id:"6925926a911597b0",children:"table.jsx-6925926a911597b0{margin:0 auto 30px}\ntable.jsx-6925926a911597b0 td.jsx-6925926a911597b0, table.jsx-6925926a911597b0 th.jsx-6925926a911597b0{padding:10px 20px}\ntable.jsx-6925926a911597b0 th.jsx-6925926a911597b0{font-weight:normal;\nfont-size:12px;\ncolor:#9b9b9b;\npadding-bottom:0px}\ntable.jsx-6925926a911597b0 td.jsx-6925926a911597b0:first-child{width:55%}\ntable.jsx-6925926a911597b0 td.jsx-6925926a911597b0{font-size:14px;\nvertical-align:middle}\ntable.jsx-6925926a911597b0 td.jsx-6925926a911597b0:last-child{color:#067df7}\ntable.jsx-6925926a911597b0 td.jsx-6925926a911597b0:not(:first-child){text-align:center}\ntable.jsx-6925926a911597b0 td.jsx-6925926a911597b0 em.jsx-6925926a911597b0{font-weight:normal;\nfont-size:10px;\ntext-transform:uppercase;\nfont-style:normal;\ndisplay:block}\n@media screen and (max-width:640px) {table.jsx-6925926a911597b0 td.jsx-6925926a911597b0, table.jsx-6925926a911597b0 th.jsx-6925926a911597b0{padding:10px 10px}}"})]})}}],o(b.prototype,c),e&&o(b,e),v}(g.Component);t.isMDXComponent=!0},54616:function(a){a.exports={figure:"image-figure_figure__DUggx",shadow:"image-figure_shadow___1DHG",figcaption:"image-figure_figcaption__LVySW"}}},function(a){a.O(0,[7582,6337,8579,5938,8632,8028,642,5315,4945,9703,2682,9468,9774,2888,179],function(){return a(a.s=10805)}),_N_E=a.O()}])